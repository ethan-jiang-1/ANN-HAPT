class MLPClassifier {

    private enum Activation { IDENTITY, LOGISTIC, RELU, TANH, SOFTMAX }

    private Activation hidden;
    private Activation output;
    private double[][] network;
    private double[][][] weights;
    private double[][] bias;

    public MLPClassifier(String hidden, String output, int[] layers, double[][][] weights, double[][] bias) {
        this.hidden = Activation.valueOf(hidden.toUpperCase());
        this.output = Activation.valueOf(output.toUpperCase());
        this.network = new double[layers.length + 1][];
        for (int i = 0, l = layers.length; i < l; i++) {
            this.network[i + 1] = new double[layers[i]];
        }
        this.weights = weights;
        this.bias = bias;
    }

    public MLPClassifier(String hidden, String output, int neurons, double[][][] weights, double[][] bias) {
        this(hidden, output, new int[] { neurons }, weights, bias);
    }

    private double[] compute(Activation activation, double[] v) {
        switch (activation) {
            case LOGISTIC:
                for (int i = 0, l = v.length; i < l; i++) {
                    v[i] = 1. / (1. + Math.exp(-v[i]));
                }
                break;
            case RELU:
                for (int i = 0, l = v.length; i < l; i++) {
                    v[i] = Math.max(0, v[i]);
                }
                break;
            case TANH:
                for (int i = 0, l = v.length; i < l; i++) {
                    v[i] = Math.tanh(v[i]);
                }
                break;
            case SOFTMAX:
                double max = Double.NEGATIVE_INFINITY;
                for (double x : v) {
                    if (x > max) {
                        max = x;
                    }
                }
                for (int i = 0, l = v.length; i < l; i++) {
                    v[i] = Math.exp(v[i] - max);
                }
                double sum = 0.;
                for (double x : v) {
                    sum += x;
                }
                for (int i = 0, l = v.length; i < l; i++) {
                    v[i] /= sum;
                }
                break;
        }
        return v;
    }

    public int predict(double[] neurons) {
        this.network[0] = neurons;

        for (int i = 0; i < this.network.length - 1; i++) {
            for (int j = 0; j < this.network[i + 1].length; j++) {
                this.network[i + 1][j] = this.bias[i][j];
                for (int l = 0; l < this.network[i].length; l++) {
                    this.network[i + 1][j] += this.network[i][l] * this.weights[i][l][j];
                }
            }
            if ((i + 1) < (this.network.length - 1)) {
                this.network[i + 1] = this.compute(this.hidden, this.network[i + 1]);
            }
        }
        this.network[this.network.length - 1] = this.compute(this.output, this.network[this.network.length - 1]);

        if (this.network[this.network.length - 1].length == 1) {
            if (this.network[this.network.length - 1][0] > .5) {
                return 1;
            }
            return 0;
        } else {
            int classIdx = 0;
            for (int i = 0; i < this.network[this.network.length - 1].length; i++) {
                classIdx = this.network[this.network.length - 1][i] > this.network[this.network.length - 1][classIdx] ? i : classIdx;
            }
            return classIdx;
        }

    }

    public static void main(String[] args) {
        if (args.length == 74) {

            // Features:
            double[] features = new double[args.length];
            for (int i = 0, l = args.length; i < l; i++) {
                features[i] = Double.parseDouble(args[i]);
            }

            // Parameters:
            int[] layers = {6};
            double[][][] weights = {{{16.049990850506468, -22.06317040726461, 6.786372569324774, 1.2796009269279713, 0.8268835879459984, -1.8764013683523624}, {26.80866314833659, -19.880017510046333, -3.7091156373492287, -11.714296288239204, 6.286756770826258, 2.558355022158692}, {-30.601446409599607, 43.401061950918624, 3.1751316890325985, -8.771111291369932, -7.028063412963528, -0.18736187779227415}, {5.328390953054942, 17.459493610472336, -19.43545331585569, 4.933908329961844, -8.40956163493037, 0.00882396331403546}, {8.937492413966021, 0.04334921281334159, -17.56978319617454, -1.6173324033144223, 6.265882800413833, 4.0162366515367856}, {-14.275628751472444, 8.478194961533664, 20.230166881114187, -2.95632088692666, -10.62214678350097, -0.6396730683067205}, {4.653753236231072, 4.6055054773539625, -6.516590592393213, 10.816872095438521, -13.289982989574147, -0.41819723037700296}, {-8.684575890235381, 5.023678254627808, -7.097608122946103, -0.37889063103052434, 6.834769073289808, 3.9758274001192637}, {23.42965947801231, 1.2378556792999247, 16.86453556041356, -22.589981366872777, -8.320971426447299, -10.678888732214547}, {1.0472308643260877, 2.8675293515031295, 0.3622629174273312, -13.9742953296909, 11.789968982033155, -2.4242842030970433}, {-11.51890351271817, 5.971332168996519, 0.8013558613939058, 2.497383484678403, -6.6791799087765495, 8.944405722394782}, {6.101620868236355, -4.456396221599098, 7.932220260903076, 4.164462357176608, -2.673821873040708, -11.01332642214285}, {-2.449393714062918, 2.025088709362572, -6.729059786353032, 20.592862466903004, -12.757711287308489, -0.628277369252733}, {0.3432938431116723, 1.1751265114086307, 4.888543143758473, -5.336968338146653, -4.4645320844933245, 2.9210591747106767}, {-14.56583766625587, 10.476177545005813, 11.173595123135389, -1.5249853342895934, -6.957832383873513, 1.5983976136727818}, {-2.1960000037387695, -5.127385091380139, 5.4834968630837615, 1.6674836302798468, 0.0643437963065244, 0.36273410866262396}, {13.848066095852149, -6.546697915473402, -17.206548187626215, 26.78595352053652, -15.637021047306368, -0.9943881652272016}, {20.3144500280487, -24.105214171307953, -18.92877585298273, 6.494561224700174, 12.140532546813418, 3.4522842753919774}, {8.686453424204885, -22.327146309341376, 24.139075750049056, -1.6315416440543935, -8.323099213865174, -0.5438909927879612}, {-6.610153094124379, -1.6528769517328985, 7.009629214294358, -13.570150358429355, 15.610667443818887, -0.7431849278381527}, {-19.675913625923343, 1.29654744264879, 9.261298669214147, 5.655162374452676, 0.623252430880215, 2.700073014741473}, {4.568502410548641, 15.790262864787394, -11.17821911352263, -0.5893469740393419, -0.034455347086155066, -8.25416726115879}, {-6.6541744952356, -3.500021201490715, 19.58462799422296, -2.9992729906028095, -3.0974599826466664, -3.46671931006958}, {-16.935667839620468, -5.866899139341052, 27.618408856618768, -1.7699204936947917, -4.106007837501824, 0.6732724518252502}, {13.892906522701272, -25.55630250429618, 8.755082592812213, 1.7043858004188703, -1.2469305697537572, 2.444260397384499}, {-8.854759477479641, -6.118155368570945, 5.308637066139716, 0.08331672758239096, 2.6551838900274265, 6.755154038463166}, {-8.539707246723557, -6.678821913935464, -12.581028186559704, 16.488475009518893, 16.750048765467998, -5.06615933249608}, {55.68621537384715, -65.48530484274787, 48.81029096068486, 10.995864010773538, 27.619753600546066, -78.00666082801239}, {-5.173663906714573, -2.5767019102359474, -2.8578899178749753, 10.092627109559489, -0.8059792688266253, 1.2061835778881542}, {-2.99306436921035, -2.969858014746875, 0.21469616629723517, 3.7567648043124446, 7.094671550712508, -5.026869522054976}, {17.963835910911516, 11.652483279624274, -15.445589928409543, -6.712444495094459, -1.0563995168957676, -6.150547999804933}, {13.249486940826428, -7.251413535803084, 6.156105833378093, -1.869457130506846, -4.454234781685279, -5.352708893699951}, {-12.983760485286194, -8.356754845377607, 23.128598634068734, 2.551472277886895, 0.0015697086895301614, -3.1909577928609045}, {16.876129285895047, 8.44767060022936, -10.696135827517095, -8.83433343127784, 0.9722561475871, -6.972399985475726}, {-3.2736682957305305, 14.454137133157369, 3.0445087076620303, -4.5577000824685845, -3.583242237520941, -6.050012683854545}, {-4.260034660134056, -13.92966700018237, 19.940488212764436, 1.5546174998604059, 0.3126382026593837, -3.658021838778635}, {-11.286661186706112, -13.56580091756547, 33.536329297089054, -5.274485299821449, 0.8970709929505657, -4.1771073633765825}, {-6.078590118898585, 0.6480952959295597, 5.4069026312798, -0.4800868711783719, 4.520230132966275, -3.999587634843124}, {-2.5146354438893916, -10.6155911709558, 11.368404608284651, -0.38380873526954623, 5.083333825817692, -2.95348706505797}, {3.5428548230980823, -13.941827268578049, -7.912276713827018, -0.2893719653654845, 13.731752680840627, 5.1412573546516205}, {-6.117561360819051, -6.38660468494959, 5.555153172970821, -13.174876400107458, 14.642312366783818, 4.628607795351262}, {2.5525033080973674, -0.368625540094981, -3.8459925678094318, -2.720950526733566, 3.144411652552779, 0.5065255261046081}, {3.3869971219075445, 2.888014711383139, 5.259782786320977, -5.311149804613758, -0.37390885520215517, -5.681908044049064}, {14.794985978456342, -15.863742675280394, 1.3141581701939609, 3.638005520256917, 2.2416174245555305, -5.864604417936743}, {-1.120008629618251, -6.10335980997219, 7.0766671938466, 7.4232863002663665, -2.8981629448508373, -5.279157901138347}, {-2.3581124941306233, 4.461314727664633, -8.187736250734647, 6.362809864011857, 3.9428437342366003, -4.410690591847995}, {-5.774756442438932, -1.0794380123445215, 21.328696523546437, -11.400798105756879, 4.367004519189004, -7.384364400564861}, {7.389719989317789, 5.488104661924792, 0.22349754301115782, -2.7706307440867706, -3.598449510059261, -6.8699114625434525}, {10.380349838146794, -0.17183252159027876, -8.316238583970867, -4.369085091186303, 6.955831550667434, -4.123121003543125}, {30.431052379749367, 24.553511356521827, -24.940151278544747, -12.46269274472207, -16.66528286799789, -1.242801306125569}, {12.617488267484854, 5.0906029974201035, 4.4710996624208095, -11.900833836524269, -5.510025136475078, -4.277029575407352}, {26.784935896055426, 9.54515011018281, -16.320238505616526, -8.357968686042907, -15.236863379412313, 3.348429714798186}, {-14.72313641255177, 14.532672277117237, -5.81270530536903, 1.4032645790731522, 5.618763598189093, -1.1065902173134035}, {7.069113320607517, -3.7374298568564885, 3.6032205077003225, -1.9416015981847727, -4.402483852648928, -0.12722260356118764}, {-0.9112559935942204, 0.01656439864506358, -16.04129635297027, 6.624442454601537, 7.051348229647854, 2.607103914754773}, {2.8150103347611233, 1.989198637959569, -1.1458337859700343, -12.199162700310815, 5.035733421128356, 3.635884518522129}, {-49.89306386394759, 3.4772372409131074, 27.917096264424416, -1.3563465484917736, 7.6462548890040525, 12.19685905797863}, {-24.278578109865567, -5.681591033710592, 7.290871534858572, -1.0914052866283803, 12.275478468461818, 10.864726474504003}, {-13.952120450856702, -1.7407068653819755, 14.754288724094314, 14.613894790768875, -21.96748936358972, 8.527636093557954}, {5.840595575826738, 8.997946485181158, -5.250746454348841, -18.62455537772777, 14.883125504647433, -5.515782099315499}, {8.004285024666324, 13.740841356761049, -14.20195865580073, -4.1373656513923205, -4.526818203267886, 1.0855012084301026}, {-5.70435529008552, -6.253028319874019, 4.674425276630403, 12.925419902850406, -8.218458328125028, 3.042414504012321}, {14.249017528792228, -20.139055873394145, -24.7196489104994, 17.25656341905953, 5.310369931947258, 8.022788209835475}, {-3.8354070755631926, -0.722044554065, 22.671273650790763, -7.696692987151439, -7.6207800265779255, -2.394658185315767}, {-3.552932890690068, 4.63255662590649, -1.4343693822985955, -0.8566744625143703, -1.4953761658346163, 2.531029468172661}, {7.560367030094029, -0.7677808113656536, 3.248391931198195, -6.2427478864787815, -0.34469403932828085, -3.3661808001526046}, {9.709970225201863, -8.566566160165289, 7.81018732008188, -8.555989408988829, 3.4218852803422766, -4.515164966585317}, {18.71285077060472, 13.666303753070881, -19.934188740336417, -11.314734661883104, 2.581966829392582, -3.3864498572046005}, {1.5691391665473204, 3.551372253590273, -3.3818435255470516, -0.7591235798125536, 4.917075158545193, -6.359099435866395}, {25.759411366218576, -0.066902858584369, -13.963766138752133, -8.572792170134733, 2.747452767897362, -5.623445289283319}, {0.8853813030499866, -5.204365574493818, 3.460519059770463, 4.923463104275762, 0.9656213994722433, -5.31877552279201}, {5.703260501675339, -15.13460316553764, 15.816120610021938, 0.2214362838573284, -0.5743046423475446, -5.654964926043357}, {21.5365185325685, 13.193549019076839, -5.202702807432661, -13.914107268924637, -14.873853309002756, -1.5359515280560003}, {-10.028134220063277, -2.4671049487273153, 1.4605598348016102, 4.2328462160625575, 4.650032997325765, 1.754317177465817}}};
            double[][] bias = {{-30.710660469422407, 14.295326358613217, 26.136746222726845, -7.781872149279182, -5.901867717871477, 4.108545786402611}};

            // Prediction:
            MLPClassifier clf = new MLPClassifier("relu", "softmax", layers, weights, bias);
            int estimation = clf.predict(features);
            System.out.println(estimation);

        }
    }
}